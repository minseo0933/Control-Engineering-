# 제어 공학  과제3 _ 2019732054 박민서


## 3-1번  



M에 대한 상태방정식은 다음과 같다.
$$
M \ddot{y} = F(t) - b \dot{y} - ky
$$  

라플라스 변환을 적용하면,
$$
M s^2 Y(s) + bs Y(s) + k Y(s) = F(s)
$$  

따라서,
$$
G(s) = \frac{Y(s)}{F(s)} = \frac{1}{Ms^2 + bs + k}
$$

또한, 이 전달함수를 phase variable canonical form으로 바꾸기 위해 분자,분모에 각각 Z(s)를 곱해준다.

$$
\frac{Y(s)}{F(s)} = \frac{\frac{1}{M}}{s^2 + \frac{b}{M} s + \frac{k}{M}} ㆍ\frac{Z(s)}{Z(s)}
$$

이를 기반으로, 아래 식이 완성된다.
$$
\begin{cases}
Y(s) = \frac{1}{M} Z(s) \\
F(s) = \left( s^2 + \frac{b}{M} s + \frac{k}{M} \right) Z(s)
\end{cases}
$$

라플라스 역변환을 적용하면,

$$
\begin{cases}
y(t) = \frac{1}{M} z(t) \\
F(t) = \ddot{z}(t) + \frac{b}{M} \dot{z}(t) + \frac{k}{M} z(t)
\end{cases}
$$  


x1(t)과 x2(t)를 다음과 같이 설정하고 상태 미분 방정식을 구하면 아래와 같다.
$$
x(t) = \begin{bmatrix} x_1(t) \\ x_2(t) \end{bmatrix} = \begin{bmatrix} z(t) \\ \dot{z}(t) \end{bmatrix} = \begin{bmatrix} z(t) \\ \frac{d}{dt}z(t) \end{bmatrix}
$$




$$
\dot{x}(t) = 
\begin{bmatrix}
0 & 1 \\
-\frac{k}{M} & -\frac{b}{M}
\end{bmatrix} x(t) + 
\begin{bmatrix}
0 \\
\frac{1}{M}
\end{bmatrix} F(t) \quad \text{(State differential equation)}
$$

출력 방정식은,

$$
y(t) = 
\begin{bmatrix}
1 & 0
\end{bmatrix} x(t)
\quad \text{(Output equation)}
$$  

이 둘을 합친 것이 State Sapce Equation이다.  
---
----------------------------------------------------------------------------
## 3-3번
커패시터 전류는 아래의 식을 따른다.
$$
i_c(t) = -C \frac{d v_c(t)}{dt}
$$


v1과 v2를 지나는 루프에 대해 KVL을 적용하면 아래 식과 같다.
$$
- V_1(t) + L \dot{x}_1(t) - x_2(t) + V_2(t) = 0
$$  

따라서 $\dot{x}_1(t)$에 대해 정리하면 아래 식과 같다.
$$
\dot{x}_1(t) = 0 \cdot x_1(t) + \frac{1}{L}x_2(t) + \frac{1}{L}v_1(t) - \frac{1}{L}v_2(t)\quad\quad\quad (1)
$$  
 


그리고 왼쪽 v1에 대한 루프에 대해 KVL을 사용하면 아래 식과 같다.
$$
- V_1(t) + L \dot{x}_1(t) + R \left( x_1(t) + C \dot{x}_1(t) \right) = 0
$$  
  
  위의 (1)식을 대입하고 $\dot{x}_2(t)$에 대해 정리하면 아래와 같다.
$$
\dot{x}_2(t) = -\frac{1}{C} x_1(t) - \frac{1}{RC} x_2(t) + \frac{1}{RC} v_2(t)\quad\quad\quad (2)
$$

(1)과 (2)를 통해 State differential Equation을 만들 수 있다.
$$
\dot{X}(t) = 
\begin{bmatrix}
0 & \frac{1}{L} \\
-\frac{1}{C} & -\frac{1}{RC}
\end{bmatrix}
X(t) + 
\begin{bmatrix}
\frac{1}{L} & -\frac{1}{L} \\
0 & \frac{1}{RC}
\end{bmatrix}
\begin{bmatrix}
V_1(t) \\
V_2(t)
\end{bmatrix}
$$
---------
-------------------------------------------------
## 3-5번
###  (a)  
 G1(s), G2(s), G3(s)를 다음과 같이 정의하면 전달함수는 아래처럼 나타낼 수 있다.
$$
\text{Let} \quad G_1(s) = \frac{s+2}{s+8}, \quad G_2(s) = \frac{1}{s-3}, \quad G_3(s) = \frac{1}{s}
$$

$$
T(s) = \frac{Y(s)}{R(s)} = \frac{G_1(s) G_2(s) G_3(s)}{1 + G_1(s) G_2(s) G_3(s)} = \frac{\frac{s+2}{s(s-3)(s+8)}}{1 + \frac{s+2}{s(s-3)(s+8)}} = \frac{s+2}{s^3 + 5s^2 - 23s + 2}
$$



###  (b)  
Phase variable canonical form으로 만들기 위해 전달함수의 분자,분모에 Z(s)를 곱하여 나타낸 후 역변환을 하고 state를 정해주면 아래와 같다.  
$$
T(s) = \frac{Y(s)}{R(s)} = \frac{s+2}{s^3 + 5s^2 - 23s + 2} \cdot \frac{Z(s)}{Z(s)}
$$

$$
\begin{cases}
y(t) = \dot{z}(t) + 2 z(t) \\
r(t) = \ddot{z}(t) + 5 \dot{z}(t) - 23 z(t) + 2 z(t)
\end{cases}
$$


$$
X(t) = 
\begin{bmatrix}
x_1(t) \\
x_2(t) \\
x_3(t)
\end{bmatrix} =
\begin{bmatrix}
z(t) \\
\dot{z}(t) \\
\ddot{z}(t)
\end{bmatrix} =
\begin{bmatrix}
z(t) \\
\dot{z}(t) \\
\ddot{z}(t)
\end{bmatrix}
$$

$$
x_4(t) = \ddot{z}(t) = -5 x_3(t) + 23 x_2(t) - 2 x_1(t) + r(t)
$$

$$
y(t) = x_2 + 2x_1
$$

따라서 phase variable canonical form으로 state sapce equation을 만들면 아래와 같다.
$$
\dot{X}(t) = 
\begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
-2 & 23 & -5
\end{bmatrix}
X(t) + 
\begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}
r(t)
$$

$$
y(t) = 
\begin{bmatrix}
2 & 1 & 0
\end{bmatrix}
X(t)
$$
---------
-------------------------------------------------
## 3-12번
(a)
앞의 문제들과 동일하게 Z(s)를 곱해주고 역변환을 해주면 아래의 y와 r에 대한 식이 만들어진다.
$$
Y(s) = (8s + 40)Z(s)
$$

$$
y(t) = 8 \dot{z}(t) + 40 z(t)
$$

$$
R(s) = (s^3 + 12s^2 + 44s + 48)Z(s)
$$

$$
r(t) = \dddot{z}(t) + 12 \ddot{z}(t) + 44 \dot{z}(t) + 48 z(t)
$$

이 식을바탕으로 state를 설정해준다.
$$
X(t) = 
\begin{bmatrix}
x_1(t) \\
x_2(t) \\
x_3(t) \\
x_4(t)
\end{bmatrix} =
\begin{bmatrix}
z(t) \\
\dot{z}(t) \\
\ddot{z}(t) \\
\dddot{z}(t)
\end{bmatrix} =
\begin{bmatrix}
z(t) \\
\dot{z}(t) \\
\ddot{z}(t)
\end{bmatrix}
$$

$$
x_4(t) = \dddot{z}(t) = -12 x_3 - 44 x_2 - 48 x_1 + r(t)
$$  


phase variable canonical form으로 변환하면 아래의 matrix을 만들 수 있다.
$$
\dot{X}(t) = 
\begin{bmatrix}
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
-48 & -44 & -12 & 0
\end{bmatrix}
X(t) + 
\begin{bmatrix}
0 \\
0 \\
0 \\
1
\end{bmatrix}
r(t)
$$

$$
y(t) = 
\begin{bmatrix}
40 & 8 & 0 & 0
\end{bmatrix}
X(t)
$$  

(b)
State transition matrix에 대한 관계식은 아래와 같다.
$$
\Phi(t) = \mathcal{L}^{-1} \left\{ \Phi(s) \right\}
$$

$$
\Phi(s) = \left[ sI - A \right]^{-1} = 
\begin{bmatrix}
s & -1 & 0 \\
0 & s & -1 \\
48 & 44 & s + 12
\end{bmatrix}^{-1}
$$  

이를 MATLAB을 통해 구하면 아래와 같다.
$$
\Phi(t) = 
\begin{bmatrix}
3e^{-2t} - 3e^{-4t} + e^{-6t} & \frac{5e^{-2t}}{4} - 2e^{-4t} + \frac{3e^{-6t}}{4} & \frac{e^{-2t}}{8} - \frac{e^{-4t}}{4} + \frac{e^{-6t}}{8} \\
12e^{-4t} - 6e^{-2t} - 6e^{-6t} & 8e^{-4t} - \frac{5e^{-2t}}{2} - \frac{9e^{-6t}}{2} & e^{-4t} - \frac{e^{-2t}}{4} - \frac{3e^{-6t}}{4} \\
12e^{-2t} - 48e^{-4t} + 36e^{-6t} & 5e^{-2t} - 32e^{-4t} + 27e^{-6t} & \frac{e^{-2t}}{2} - 4e^{-4t} + \frac{9e^{-6t}}{2}
\end{bmatrix}
$$
---------
-------------------------------------------------
## 3-17번
계수 행렬을 각각 A,B,C,D라 하면 아래처럼 식을 전개하면서 Y(s)와 U(s)사이의 관계식을 도출해날 수 있다.
$$
s X(s) = A X(s) + B U(s)
$$

$$
(sI - A) X(s) = B U(s)
$$

$$
X(s) = (sI - A)^{-1} B U(s)
$$

그리고,

Y(s) = C X(s)
$$  


위의 X(s) 식을 대입하면,
$$
Y(s) = C (sI - A)^{-1} B U(s)
$$  



따라서 전달 함수는,
$$
G(s) = \frac{Y(s)}{U(s)} = C (sI - A)^{-1} B
$$

행렬로 표현하면,

$$
G(s) = 
\begin{bmatrix}
1 & 0 & 0
\end{bmatrix}
\begin{bmatrix}
s-1 & -1 & 1 \\
-4 & s-3 & 0 \\
2 & -1 & s-10
\end{bmatrix}^{-1}
\begin{bmatrix}
0 \\
0 \\
4
\end{bmatrix}
$$

결과는,

$$
G(s) = \frac{4(s-5)}{s^3 - 14s^2 + 37s + 20}
$$
